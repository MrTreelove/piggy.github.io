# Piggy 记账本应用需求文档

## 1. 项目概述

### 1.1 项目名称
Piggy - 智能记账本应用

### 1.2 项目背景
随着移动支付的普及，个人财务管理变得越来越重要。Piggy 旨在为用户提供一个简单、直观、功能完善的记账工具，帮助用户更好地管理个人财务，培养良好的消费习惯。

### 1.3 项目目标
- 提供用户认证功能，确保数据安全和隐私
- 提供便捷的记账功能，支持快速记录收支
- 提供多维度数据统计和分析
- 支持多账户管理
- 提供预算管理和提醒功能
- 支持数据导出和备份
- 确保用户数据隔离，每个用户仅能查看和管理自己的数据

## 2. 用户角色

### 2.1 主要用户
- **普通用户**：需要记录日常收支的个人用户
- **家庭用户**：需要管理家庭财务的用户
- **学生用户**：需要管理零花钱和奖学金的学生

### 2.2 用户认证
- 每个用户需要注册账号并登录后才能使用应用
- 用户数据完全隔离，登录用户仅能查看和管理自己的账户、交易记录、预算等数据
- 支持多用户同时使用，互不干扰

## 3. 功能需求

### 3.0 用户认证与授权

#### 3.0.1 用户注册
- 用户注册功能（用户名/邮箱、密码）
- 密码强度验证
- 邮箱验证（可选）
- 注册协议确认

#### 3.0.2 用户登录
- 用户名/邮箱登录
- 密码登录
- 记住登录状态（可选）
- 自动登录功能（可选）
- 登录失败提示和账户锁定机制

#### 3.0.3 用户登出
- 安全登出功能
- 登出后清除本地会话数据

#### 3.0.4 密码管理
- 修改密码功能
- 忘记密码重置功能
- 密码找回（通过邮箱）

#### 3.0.5 数据隔离
- **核心要求**：每个登录用户仅能查看和管理自己的数据
- 用户账户隔离：用户只能看到自己创建的账户
- 交易记录隔离：用户只能看到自己记录的交易
- 分类隔离：用户只能看到自己创建或使用的分类
- 预算隔离：用户只能看到自己设置的预算
- 统计数据隔离：统计仅显示当前用户的数据
- 数据导出隔离：导出仅包含当前用户的数据
- 后端API必须验证用户身份，确保数据访问权限

### 3.1 账户管理

#### 3.1.1 账户类型
- 现金账户
- 银行卡账户（支持多张银行卡）
- 支付宝账户
- 微信钱包账户
- 信用卡账户
- 其他自定义账户类型

#### 3.1.2 账户功能
- 创建/编辑/删除账户（仅限当前登录用户）
- 设置账户初始余额
- 查看账户余额（仅显示当前用户的账户）
- 账户间转账功能（仅限当前用户的账户之间）
- 账户图标和颜色自定义
- 查看账户账单（该账户的所有交易记录，仅限当前用户的账户）

#### 3.1.3 账户账单功能
- 查看指定账户的所有交易记录（收入、支出、转账，仅限当前用户的账户）
- 按时间排序显示账户账单
- 账户账单统计（该账户的收入总额、支出总额、净收支）
- 账户账单筛选（按时间范围、交易类型、分类筛选）
- 账户账单搜索（按备注、金额、分类搜索）
- 账户余额变化趋势（显示账户余额随时间的变化）
- 账户账单导出（导出该账户的交易记录，仅限当前用户的数据）

### 3.2 记账功能

#### 3.2.1 收入记录
- 快速记录收入金额（仅记录到当前用户的账户）
- 选择收入账户（仅显示当前用户的账户）
- 选择收入分类（工资、奖金、投资收益、其他等，仅显示当前用户的分类）
- 添加备注信息
- 选择记录时间（支持历史日期）
- 添加图片附件（如发票、收据）

#### 3.2.2 支出记录
- 快速记录支出金额（仅记录到当前用户的账户）
- 选择支出账户（仅显示当前用户的账户）
- 选择支出分类（餐饮、交通、购物、娱乐、医疗、教育、其他等，仅显示当前用户的分类）
- 添加备注信息
- 选择记录时间（支持历史日期）
- 添加图片附件（如发票、收据）
- 支持标签功能（如"必要支出"、"冲动消费"等）

#### 3.2.3 转账记录
- 记录账户间转账（仅限当前用户的账户之间）
- 选择转出账户和转入账户（仅显示当前用户的账户）
- 记录转账金额
- 添加备注信息
- 选择记录时间

#### 3.2.4 批量操作
- 批量删除记录（仅限当前用户的记录）
- 批量修改分类（仅限当前用户的记录）
- 批量导出记录（仅导出当前用户的记录）

### 3.3 分类管理

#### 3.3.1 分类功能
- 预设常用分类（每个用户独立）
- 自定义分类（收入/支出，仅限当前用户）
- 分类图标和颜色自定义
- 分类排序功能
- 分类统计功能（仅统计当前用户的交易）

#### 3.3.2 分类层级
- 支持一级分类
- 支持二级分类（可选）
- 分类树形结构展示

### 3.4 数据统计与分析

#### 3.4.1 统计维度
- **时间维度**：日、周、月、年统计（仅统计当前用户的数据）
- **分类维度**：按分类统计收支（仅统计当前用户的分类和交易）
- **账户维度**：按账户统计余额变化（仅统计当前用户的账户）
- **账户账单维度**：按账户查看该账户的详细账单统计（仅限当前用户的账户）
- **趋势分析**：收支趋势图表（仅显示当前用户的数据）

#### 3.4.2 统计图表
- 饼图：分类支出占比
- 柱状图：月度收支对比
- 折线图：收支趋势
- 环形图：账户余额分布

#### 3.4.3 统计报表
- 日报表
- 周报表
- 月报表
- 年报表
- 自定义时间段报表

### 3.5 预算管理

#### 3.5.1 预算设置
- 设置月度总预算（仅限当前用户）
- 按分类设置预算（仅限当前用户的分类）
- 预算周期设置（月/周/年）
- 预算提醒阈值设置

#### 3.5.2 预算监控
- 实时显示预算使用情况
- 预算超支提醒
- 预算进度可视化
- 预算执行报告

### 3.6 搜索与筛选

#### 3.6.1 搜索功能
- 按金额搜索
- 按备注搜索
- 按分类搜索
- 按账户搜索
- 按时间范围搜索
- 组合条件搜索

#### 3.6.2 筛选功能
- 按类型筛选（收入/支出/转账，仅显示当前用户的记录）
- 按分类筛选（仅显示当前用户的分类）
- 按账户筛选（支持多账户选择，仅显示当前用户的账户）
- 按时间范围筛选
- 按金额范围筛选
- 按标签筛选
- 在账户账单页面，默认筛选显示该账户的所有交易记录（仅限当前用户的账户）

### 3.7 数据管理

#### 3.7.1 数据导出
- 导出为 Excel 格式（仅导出当前用户的数据）
- 导出为 CSV 格式（仅导出当前用户的数据）
- 导出为 PDF 报表（仅导出当前用户的数据）
- 自定义导出字段

#### 3.7.2 数据备份
- 自动备份功能（仅备份当前用户的数据）
- 手动备份功能（仅备份当前用户的数据）
- 备份到云端（可选，需要用户认证）
- 备份恢复功能（仅恢复当前用户的数据）

#### 3.7.3 数据导入
- 从 Excel 导入（导入到当前用户账户）
- 从 CSV 导入（导入到当前用户账户）
- 从其他记账应用导入（可选，导入到当前用户账户）

### 3.8 提醒功能

#### 3.8.1 记账提醒
- 每日记账提醒
- 自定义提醒时间
- 提醒开关控制

#### 3.8.2 预算提醒
- 预算超支提醒
- 预算使用进度提醒

#### 3.8.3 账单提醒
- 信用卡还款提醒
- 定期支出提醒（如房租、水电费等）

### 3.9 设置功能

#### 3.9.1 基础设置
- 货币单位设置
- 日期格式设置
- 语言设置
- 主题设置（浅色/深色）

#### 3.9.2 安全设置
- 密码保护
- 指纹/面容识别（移动端）
- 数据加密

#### 3.9.3 其他设置
- 默认账户设置
- 默认分类设置
- 快捷操作设置

## 4. 非功能需求

### 4.1 性能需求
- 应用启动时间 < 2秒
- 记账操作响应时间 < 500ms
- 数据查询响应时间 < 1秒
- 支持至少 10,000 条记录流畅操作

### 4.2 可用性需求
- 界面简洁直观，易于操作
- 支持快速记账（3步内完成）
- 提供操作引导和帮助文档
- 支持键盘快捷键（桌面端）

### 4.3 兼容性需求
- 支持主流操作系统（iOS、Android、Web、桌面端）
- 支持主流浏览器（Chrome、Safari、Firefox、Edge）
- 响应式设计，适配不同屏幕尺寸

### 4.4 安全性需求
- **用户认证**：必须登录后才能使用应用
- **数据隔离**：每个用户的数据完全隔离，无法访问其他用户的数据
- **密码安全**：密码加密存储，支持密码强度验证
- **会话管理**：安全的会话管理，支持自动登出
- **API安全**：所有API请求必须验证用户身份和权限
- 本地数据加密存储
- 支持密码保护
- 支持生物识别（移动端）
- 数据备份加密
- 防止SQL注入、XSS等安全攻击

### 4.5 可维护性需求
- 代码结构清晰，易于维护
- 完善的日志记录
- 错误处理和异常捕获
- 支持热更新（Web/移动端）

## 5. 技术需求

### 5.1 技术栈建议
- **前端框架**：React / Vue.js / Flutter
- **后端框架**：Node.js / Python / Go（如需要）
- **数据库**：SQLite（本地） / PostgreSQL（云端）
- **状态管理**：Redux / MobX / Zustand
- **UI 组件库**：Ant Design / Material-UI / Tailwind CSS

### 5.2 数据存储
- **用户数据隔离**：数据库设计必须包含用户ID字段，所有数据关联到用户
- 本地数据库存储（SQLite，每个用户独立数据）
- 云端数据库存储（PostgreSQL/MySQL，支持多用户，通过用户ID隔离）
- 可选云端同步（需要后端支持，需要用户认证）
- 数据备份文件存储（按用户隔离）
- **数据表设计**：所有业务表必须包含 user_id 字段用于数据隔离

### 5.3 第三方服务（可选）
- 图表库：ECharts / Chart.js / Recharts
- 文件处理：Excel/CSV 解析库
- 云存储服务（如需要）

## 6. 界面需求

### 6.1 主要页面
0. **登录/注册页面**
   - 用户登录表单（用户名/邮箱、密码）
   - 用户注册表单（用户名/邮箱、密码、确认密码）
   - 忘记密码链接
   - 记住登录状态选项
   - 登录/注册错误提示

1. **首页/仪表盘**
   - 账户余额总览
   - 本月收支统计
   - 快速记账入口
   - 最近交易记录

2. **记账页面**
   - 收入/支出/转账切换
   - 金额输入
   - 账户选择
   - 分类选择
   - 备注输入
   - 时间选择

3. **记录列表页**
   - 交易记录列表
   - 筛选和搜索
   - 编辑和删除功能

4. **统计页面**
   - 统计图表展示
   - 时间段选择
   - 分类统计
   - 趋势分析

5. **账户管理页**
   - 账户列表
   - 账户余额
   - 账户操作（添加/编辑/删除）
   - 查看账户账单入口

6. **账户账单详情页**
   - 账户基本信息（账户名称、类型、当前余额）
   - 账户交易记录列表（该账户的所有收入、支出、转账记录）
   - 账户账单统计（收入总额、支出总额、净收支、交易笔数）
   - 账户余额变化趋势图
   - 账户账单筛选和搜索
   - 账户账单导出功能

7. **预算管理页**
   - 预算设置
   - 预算执行情况
   - 预算提醒

8. **设置页面**
   - 用户信息管理（修改用户名、邮箱等）
   - 密码修改
   - 各种设置选项
   - 数据管理
   - 关于信息
   - 登出功能

### 6.3 访问控制
- 未登录用户只能访问登录/注册页面
- 登录后才能访问其他所有页面
- 所有数据查询和操作必须验证当前登录用户身份
- 页面路由需要身份验证中间件保护

### 6.2 设计原则
- 简洁美观的界面设计
- 清晰的信息层级
- 一致的操作体验
- 友好的错误提示
- 流畅的动画过渡

## 7. 开发计划

### 7.1 第一阶段：核心功能（MVP）
- **用户认证系统**（登录、注册、登出）
- **数据隔离机制**（用户数据完全隔离）
- 账户管理（仅限当前用户）
- 基础记账功能（收入/支出，仅限当前用户）
- 分类管理（仅限当前用户）
- 记录列表和查询（仅显示当前用户的记录）
- 基础统计（仅统计当前用户的数据）
- 账户账单查看（查看单个账户的交易记录，仅限当前用户的账户）

### 7.2 第二阶段：增强功能
- 转账功能
- 高级统计和图表
- 预算管理
- 数据导出
- 提醒功能

### 7.3 第三阶段：优化和完善
- 数据备份和恢复
- 数据导入
- 多账户高级功能
- 账户账单高级统计（余额变化趋势、分类统计等）
- 账户账单导出功能
- 性能优化
- UI/UX 优化

## 8. 测试需求

### 8.1 功能测试
- 所有功能的正常流程测试
- 边界条件测试
- 异常情况测试
- **用户认证测试**：登录、注册、登出功能测试
- **数据隔离测试**：验证用户A无法访问用户B的数据
- **权限测试**：验证所有API和页面访问都需要身份验证
- **安全性测试**：密码加密、会话管理、SQL注入防护等

### 8.2 性能测试
- 大数据量测试
- 响应时间测试
- 内存使用测试

### 8.3 兼容性测试
- 不同设备测试
- 不同浏览器测试
- 不同操作系统测试

### 8.4 用户体验测试
- 可用性测试
- 用户反馈收集
- 界面优化

## 9. 后续扩展功能（可选）

### 9.1 社交功能
- 家庭账本共享
- 消费排行榜
- 理财建议

### 9.2 智能功能
- 消费习惯分析
- 智能分类识别
- 消费预测
- AI 理财建议

### 9.3 高级功能
- 多币种支持
- 投资记录
- 债务管理
- 报表定制

## 10. 附录

### 10.1 术语表
- **用户账户**：应用登录账号，每个用户有独立的账号和密码
- **账户**：用于存储资金的容器，如现金、银行卡等（每个用户可以有多个账户）
- **分类**：对收支进行归类的标签（每个用户独立管理）
- **预算**：预设的支出限额（每个用户独立设置）
- **转账**：账户间的资金转移（仅限同一用户的账户之间）
- **数据隔离**：每个用户的数据完全独立，无法访问其他用户的数据

### 10.2 参考资源
- 其他记账应用的优秀设计
- 财务管理最佳实践
- 用户体验设计指南

---

**文档版本**：v1.2  
**创建日期**：2025-01-27  
**最后更新**：2025-01-27  
**更新说明**：
- v1.1 - 新增账户账单查看功能，支持每个账户独立查看自己的交易记录和统计信息
- v1.2 - 新增用户认证功能，要求登录账户仅可看到自己的账户详情，实现数据完全隔离

